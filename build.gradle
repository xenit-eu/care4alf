apply plugin: 'scala'
apply plugin: 'idea'
apply plugin: 'alfresco-dynamic-extension'

[compileJava, compileTestJava,javadoc]*.options*.encoding = 'UTF-8'

[compileJava,compileScala]*.sourceCompatibility = 1.6
[compileJava,compileScala]*.targetCompatibility = 1.6

tasks.withType(ScalaCompile) {
    scalaCompileOptions.useAnt = false
    scalaCompileOptions.additionalParameters = ['-feature']
}

buildscript {
    repositories {
        mavenLocal()
	jcenter()
        mavenCentral()
        maven {
            url 'http://artifactory.local.xenit.eu/artifactory/libs-release-local'
        }
    }
    dependencies {
        classpath(group: 'com.github.dynamicextensionsalfresco', name: 'gradle-plugin', version: '1.1.+')
    }
}

ext.alfrescoVersion = '4.2.f'
ext.springVersion = '3.2.10.RELEASE'

repositories {
    maven { url "http://artifactory.local.xenit.eu/artifactory/repo1" }
    maven { url "http://artifactory.local.xenit.eu/artifactory/alfresco-community" }
    maven { url "http://artifactory.local.xenit.eu/artifactory/spring-release" }
    maven { url "http://artifactory.local.xenit.eu/artifactory/libs-release-local" }
    maven { url 'http://artifactory.local.xenit.eu/artifactory/typesafe' }
}

dependencies {
    compile ("org.alfresco:alfresco-core:${alfrescoVersion}") { transitive = false }
    compile ("org.alfresco:alfresco-repository:${alfrescoVersion}") { transitive = false }
    compile ("org.alfresco:alfresco-data-model:${alfrescoVersion}") { transitive = true }

    compile "org.springframework:spring-context:${project.springVersion}"
    compile "org.springframework:spring-jdbc:${project.springVersion}"
    compile "org.osgi:org.osgi.core:4.3.1"
    compile 'org.json:json:20090211'
    compile "org.scala-lang:scala-library:2.10.3"
    compile("acegisecurity:acegi-security:0.8.2") {transitive = false}
    compile('com.typesafe:scalalogging-slf4j_2.10:1.0.1')
    compile "org.slf4j:slf4j-api:1.7.5"
    compile 'org.eclipse.gemini:org.eclipse.gemini.blueprint.core:1.0.2.RELEASE'
    compile('javax.transaction:transaction-api:1.1') {transitive = false}
    compile('org.jibx:jibx-run:1.2.3') {transitive = false}
    compile('com.googlecode.json-simple:json-simple:1.1')
}

alfrescoDynamicExtensions {
    repository {
        endpoint {
            host = project.hasProperty('host') ? project.host : 'localhost'
            port = project.hasProperty('port') ? project.port : '8080'
            serviceUrl = '/alfresco/service'
        }
        authentication {
            username = project.hasProperty('username') ? project.username : 'admin'
            password = project.hasProperty('password') ? project.username : 'admin'
        }
    }
}
